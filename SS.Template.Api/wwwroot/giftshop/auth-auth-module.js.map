{"version":3,"sources":["./src/app/auth/login/login.component.html","./src/app/auth/auth-routing.module.ts","./src/app/auth/auth.module.ts","./src/app/auth/login/login.component.scss","./src/app/auth/login/login.component.ts","./src/app/auth/services/login.service.ts","./src/app/common/models/login-status.ts"],"names":[],"mappings":"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","file":"auth-auth-module.js","sourcesContent":["export default \"<div [ngSwitch]=\\\"currentStage\\\">\\n\\n  <div *ngSwitchCase=\\\"Stage.Login\\\">\\n    <form [formGroup]=\\\"form\\\" (ngSubmit)=\\\"submit()\\\" autocomplete=\\\"off\\\" class=\\\"form-signin\\\">\\n      <h3 class=\\\"text-left txt-primary\\\">\\n        {{ 'auth.login.$TITLE' | translate }}\\n      </h3>\\n      <hr />\\n      <div class=\\\"form-group\\\">\\n        <input type=\\\"email\\\" class=\\\"form-control\\\" formControlName=\\\"email\\\" placeholder=\\\"Email\\\" autofocus />\\n        <div class=\\\"messages\\\" *ngIf=\\\"submitted &amp;&amp; form.controls.email.invalid\\\">\\n          <p [hidden]=\\\"!form.controls.email.errors.required\\\" class=\\\"text-danger error\\\">\\n            {{ 'validations.REQUIRED' | translate }}\\n          </p>\\n          <p [hidden]=\\\"!form.controls.email.errors.email\\\" class=\\\"text-danger error\\\">\\n            {{ 'validations.INVALID_EMAIL' | translate }}\\n          </p>\\n        </div>\\n      </div>\\n      <div class=\\\"form-group\\\">\\n        <input type=\\\"password\\\" class=\\\"form-control\\\" formControlName=\\\"password\\\" placeholder=\\\"Password\\\" />\\n        <div class=\\\"messages\\\" *ngIf=\\\"submitted &amp;&amp; form.controls.password.invalid\\\">\\n          <p [hidden]=\\\"!form.controls.password.errors.required\\\" class=\\\"text-danger error\\\">\\n            {{ 'validations.REQUIRED' | translate }}\\n          </p>\\n        </div>\\n      </div>\\n      <p class=\\\"forgot-phone text-right\\\">\\n        <a class=\\\"text-right f-w-600 text-inverse\\\" [routerLink]=\\\"['../forgot-password']\\\">\\n          {{ 'auth.login.FORGOT_PASSWORD' | translate }}\\n        </a>\\n      </p>\\n      <button type=\\\"submit\\\" class=\\\"btn btn-primary btn-md btn-block waves-effect text-center m-b-20\\\"\\n        [disabled]=\\\"submitting\\\">\\n        <i class=\\\"fa fa-refresh fa-spin fa-spin-1s fa-fw\\\" [hidden]=\\\"!submitting\\\"></i>\\n        {{ 'auth.login.LOG_IN' | translate }}\\n      </button>\\n    </form>\\n  </div>\\n  <div *ngSwitchCase=\\\"Stage.Lockout\\\">\\n    <div class=\\\"text-center\\\">\\n      <i class=\\\"fa fa-lock fa-5x\\\"></i>\\n      <h4>{{ 'auth.login.LOCKED_OUT' | translate }}</h4>\\n    </div>\\n    <button type=\\\"button\\\" class=\\\"btn btn-link\\\" (click)=\\\"reset()\\\">{{ 'app.BACK' | translate }}</button>\\n  </div>\\n  <div *ngSwitchCase=\\\"Stage.TwoFactor\\\">\\n\\n  </div>\\n</div>\\n<div class=\\\"text-center\\\">\\n  <app-version></app-version>\\n</div>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { LoginComponent } from './login/login.component';\n\nconst routes: Routes = [\n  {\n    path: 'login',\n    component: LoginComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class AuthRoutingModule { }\n","import { NgModule } from '@angular/core';\n\nimport { AuthRoutingModule } from './auth-routing.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { LoginService } from './services/login.service';\nimport { LoginComponent } from './login/login.component';\n\n@NgModule({\n  declarations: [LoginComponent],\n  imports: [\n    SharedModule,\n    AuthRoutingModule\n  ],\n  providers: [LoginService]\n})\nexport class AuthModule { }\n","export default \".form-signin {\\n  width: 100%;\\n  max-width: 330px;\\n  padding: 15px;\\n  margin: auto; }\\n  .form-signin .checkbox {\\n    font-weight: 400; }\\n  .form-signin .form-control {\\n    position: relative;\\n    box-sizing: border-box;\\n    height: auto;\\n    padding: 10px;\\n    font-size: 16px; }\\n  .form-signin .form-control:focus {\\n    z-index: 2; }\\n  .form-signin input[type=\\\"email\\\"] {\\n    margin-bottom: -1px;\\n    border-bottom-right-radius: 0;\\n    border-bottom-left-radius: 0; }\\n  .form-signin input[type=\\\"password\\\"] {\\n    margin-bottom: 10px;\\n    border-top-left-radius: 0;\\n    border-top-right-radius: 0; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXV0aC9sb2dpbi9DOlxcVXNlcnNcXGxhcmlhc1xcRG9jdW1lbnRzXFxHaWZ0U2hvcFxcU1MuVGVtcGxhdGUuQXBpXFx3d3dyb290XFxhbmd1bGFyX3RlbXBsYXRlLW1hc3Rlci9zcmNcXGFwcFxcYXV0aFxcbG9naW5cXGxvZ2luLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBVztFQUNYLGdCQUFnQjtFQUNoQixhQUFhO0VBQ2IsWUFBWSxFQUFBO0VBSmQ7SUFPSSxnQkFBZ0IsRUFBQTtFQVBwQjtJQVVJLGtCQUFrQjtJQUNsQixzQkFBc0I7SUFDdEIsWUFBWTtJQUNaLGFBQWE7SUFDYixlQUFlLEVBQUE7RUFkbkI7SUFpQkksVUFBVSxFQUFBO0VBakJkO0lBb0JJLG1CQUFtQjtJQUNuQiw2QkFBNkI7SUFDN0IsNEJBQTRCLEVBQUE7RUF0QmhDO0lBeUJJLG1CQUFtQjtJQUNuQix5QkFBeUI7SUFDekIsMEJBQTBCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9hdXRoL2xvZ2luL2xvZ2luLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmZvcm0tc2lnbmluIHtcbiAgd2lkdGg6IDEwMCU7XG4gIG1heC13aWR0aDogMzMwcHg7XG4gIHBhZGRpbmc6IDE1cHg7XG4gIG1hcmdpbjogYXV0bztcblxuICAuY2hlY2tib3gge1xuICAgIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIH1cbiAgLmZvcm0tY29udHJvbCB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgaGVpZ2h0OiBhdXRvO1xuICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgZm9udC1zaXplOiAxNnB4O1xuICB9XG4gIC5mb3JtLWNvbnRyb2w6Zm9jdXMge1xuICAgIHotaW5kZXg6IDI7XG4gIH1cbiAgaW5wdXRbdHlwZT1cImVtYWlsXCJdIHtcbiAgICBtYXJnaW4tYm90dG9tOiAtMXB4O1xuICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAwO1xuICAgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6IDA7XG4gIH1cbiAgaW5wdXRbdHlwZT1cInBhc3N3b3JkXCJdIHtcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDA7XG4gICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6IDA7XG4gIH1cbn1cbiJdfQ== */\"","import { Component } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { LoginStatus } from '../../common/models/login-status';\nimport { Translation } from '../../common/models/translation.model';\nimport { NotificationService } from '../../core/services/notification.service';\nimport { ErrorHandlerService } from '../../core/services/error-handler.service';\nimport { RedirectService } from '../../core/services/redirect.service';\nimport { LoginService } from '../services/login.service';\nimport { AppValidators } from '../../common/app-validators';\n\nenum Stage {\n  Login,\n  Lockout,\n  TwoFactor\n}\n\nfunction getLoginStatusMessage(status: LoginStatus): Translation {\n  return { key: `auth.loginStatusDescription.${status}` };\n}\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss']\n})\nexport class LoginComponent {\n\n  public form: FormGroup;\n  public submitted = false;\n  public readonly Stage = Stage;\n  public currentStage = Stage.Login;\n  public submitting = false;\n\n  constructor(\n    fb: FormBuilder,\n    private _route: ActivatedRoute,\n    private _errorHandler: ErrorHandlerService,\n    private _notificationService: NotificationService,\n    private _redirectService: RedirectService,\n    private _loginService: LoginService) {\n\n    this.form = fb.group({\n      email: ['', [Validators.required, AppValidators.email]],\n      password: ['', [Validators.required]]\n    });\n\n    this._redirectService.reset();\n  }\n\n\n  submit() {\n    if (this.submitting) {\n      return;\n    }\n\n    this.submitted = true;\n    if (this.form.invalid) {\n      return;\n    }\n\n    const model = this.form.value;\n\n    this.submitting = true;\n    this._loginService.login(model)\n      .subscribe((result) => {\n        switch (result.status) {\n          case LoginStatus.Success:\n            setTimeout(() => {\n              this.navigate();\n            }, 10);\n            break;\n          case LoginStatus.IsLockedOut:\n            this.currentStage = Stage.Lockout;\n            break;\n          case LoginStatus.Inactive:\n          case LoginStatus.NotAllowed:\n          case LoginStatus.Failed:\n          case LoginStatus.NotConfirmed:\n            this._notificationService.error(getLoginStatusMessage(result.status));\n            break;\n          case LoginStatus.RequiresTwoFactor:\n            // TODO: Process two factor authentication\n            this.currentStage = Stage.TwoFactor;\n            break;\n          default:\n            this._notificationService.error({ key: 'errors.UNKNOWN' });\n            break;\n        }\n        this.submitting = false;\n      }, error => {\n        this._errorHandler.handle(error);\n        this.submitting = false;\n      });\n  }\n\n  onPasswordUpdated() {\n    this.navigate();\n  }\n\n  reset() {\n    this.submitted = false;\n    this.form.reset({});\n    this.currentStage = Stage.Login;\n  }\n\n  private navigate() {\n    this._redirectService.fromRoute(this._route.snapshot);\n  }\n}\n","import { Injectable, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\n\nimport { API_URL } from '../../core/api-url.token';\nimport { LoginResult } from '../../common/models/login-result.model';\nimport { IUser } from '../../interface/IUser';\n\n@Injectable({\n  providedIn:'root'\n}\n)\nexport class LoginService {\n  private readonly _url: string;\n\n  constructor(private _httpClient: HttpClient, @Inject(API_URL) apiUrl: string) {\n    this._url = `${apiUrl}/api/account/`;\n  }\n\n  login(model: IUser): any {\n    return this._httpClient.post(`${this._url}login`, model, { withCredentials: true });\n  }\n\n}\n","export enum LoginStatus {\n  Failed = 0,\n  Inactive = 1,\n  NotConfirmed = 2,\n  RequiresTwoFactor = 3,\n  IsLockedOut = 4,\n  PasswordExpired = 5,\n  Success = 200,\n  NotAllowed = 401\n}\n"],"sourceRoot":"webpack:///"}